<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Daily Digest — {{ date }}</title>
  <style>
    body { margin: 0; padding: 0; background-color: #f4f4f7; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; color: #1a1a2e; }
    .wrapper { max-width: 640px; margin: 0 auto; background: #ffffff; }
    .header { background: #1a1a2e; color: #ffffff; padding: 24px 32px; }
    .header h1 { margin: 0; font-size: 22px; font-weight: 700; }
    .header .date { color: #a0a0b8; font-size: 14px; margin-top: 4px; }
    .overview { padding: 20px 32px; background: #f0f0ff; border-left: 4px solid #5b5bf0; font-size: 15px; line-height: 1.5; }
    .section { padding: 20px 32px; }
    .section-title { font-size: 13px; font-weight: 700; text-transform: uppercase; letter-spacing: 1px; color: #5b5bf0; border-bottom: 2px solid #e0e0f0; padding-bottom: 8px; margin-bottom: 16px; }
    .event { margin-bottom: 20px; padding-bottom: 16px; border-bottom: 1px solid #f0f0f5; }
    .event:last-child { border-bottom: none; }
    .event-title { font-size: 16px; font-weight: 600; margin: 0 0 6px 0; }
    .event-badges { margin-bottom: 8px; }
    .badge { display: inline-block; font-size: 11px; font-weight: 600; padding: 2px 8px; border-radius: 3px; margin-right: 4px; }
    .badge-high { background: #ffe0e0; color: #c00; }
    .badge-medium { background: #fff3e0; color: #c06000; }
    .badge-low { background: #e8f5e9; color: #2e7d32; }
    .badge-cat { background: #e8eaf6; color: #3949ab; }
    .event-company { font-size: 13px; color: #666; margin-bottom: 6px; }
    .event-body { font-size: 14px; line-height: 1.6; }
    .event-body strong { color: #333; }
    .event-body ul { margin: 4px 0; padding-left: 20px; }
    .event-body li { margin-bottom: 4px; }
    .event-sources { font-size: 12px; color: #888; margin-top: 8px; }
    .event-sources a { color: #5b5bf0; }
    .radar-card { background: #f8f9ff; border: 1px solid #e0e0f0; border-radius: 8px; padding: 16px; margin-bottom: 12px; }
    .radar-card h4 { margin: 0 0 6px 0; font-size: 15px; }
    .radar-card p { margin: 4px 0; font-size: 13px; line-height: 1.5; }
    .radar-signals { font-size: 12px; color: #888; margin-top: 8px; }
    .skim-item { font-size: 14px; line-height: 1.6; padding: 4px 0; }
    .skim-item a { color: #5b5bf0; text-decoration: none; }
    .footer { background: #1a1a2e; color: #a0a0b8; padding: 20px 32px; text-align: center; font-size: 12px; }
    .footer a { color: #8080ff; }
  </style>
</head>
<body>
  <div class="wrapper">
    <!-- HEADER -->
    <div class="header">
      <h1>AI Daily Digest</h1>
      <div class="date">{{ date }}</div>
    </div>

    <!-- OVERVIEW -->
    {% if overview %}
    <div class="overview">{{ overview }}</div>
    {% endif %}

    <!-- TOP 5 -->
    {% if sections.top5 %}
    <div class="section">
      <div class="section-title">[1] Top 5 — High Impact</div>
      {% for event in sections.top5 %}
      <div class="event">
        <div class="event-title">{{ loop.index }}. {{ event.title }}</div>
        <div class="event-badges">
          <span class="badge badge-{{ event.severity|lower }}">{{ event.severity }}</span>
          {% for cat in event.categories[:2] %}
          <span class="badge badge-cat">{{ cat }}</span>
          {% endfor %}
        </div>
        <div class="event-company">{{ event.company_name }}{% if event.product_line %} / {{ event.product_line }}{% endif %}</div>
        <div class="event-body">
          {% if event.what_changed %}
          <strong>What changed:</strong>
          <ul>
            {% for item in event.what_changed %}
            <li>{{ item.fact if item is mapping else item }}{% if item is mapping and item.citation_url %} <a href="{{ item.citation_url }}">[source]</a>{% endif %}</li>
            {% endfor %}
          </ul>
          {% endif %}
          {% if event.why_it_matters %}
          <strong>Why it matters:</strong> {{ event.why_it_matters }}
          {% endif %}
          {% if event.action_items %}
          <strong>Action items:</strong>
          <ul>
            {% for action in event.action_items %}
            <li>{{ action }}</li>
            {% endfor %}
          </ul>
          {% endif %}
        </div>
        {% if event.citations %}
        <div class="event-sources">
          Sources: {% for url in event.citations %}<a href="{{ url }}">{{ url|truncate(50) }}</a>{% if not loop.last %}, {% endif %}{% endfor %}
          | {{ event.confidence }} | Tier {{ event.trust_tier }}
        </div>
        {% endif %}
      </div>
      {% endfor %}
    </div>
    {% endif %}

    <!-- DEVELOPER CHANGES -->
    {% if sections.developer %}
    <div class="section">
      <div class="section-title">[2] Developer Changes (API / SDK / Deprecations)</div>
      {% for event in sections.developer %}
      <div class="event">
        <div class="event-title">{{ event.title }}</div>
        <div class="event-badges">
          <span class="badge badge-{{ event.severity|lower }}">{{ event.severity }}</span>
          {% for cat in event.categories[:2] %}
          <span class="badge badge-cat">{{ cat }}</span>
          {% endfor %}
        </div>
        <div class="event-company">{{ event.company_name }}{% if event.product_line %} / {{ event.product_line }}{% endif %}</div>
        <div class="event-body">
          {% if event.summary_short %}{{ event.summary_short }}{% endif %}
        </div>
        {% if event.citations %}
        <div class="event-sources">
          Sources: {% for url in event.citations %}<a href="{{ url }}">{{ url|truncate(50) }}</a>{% if not loop.last %}, {% endif %}{% endfor %}
        </div>
        {% endif %}
      </div>
      {% endfor %}
    </div>
    {% endif %}

    <!-- MODELS & CAPABILITIES -->
    {% if sections.models %}
    <div class="section">
      <div class="section-title">[3] Models &amp; Capabilities</div>
      {% for event in sections.models %}
      <div class="event">
        <div class="event-title">{{ event.title }}</div>
        <div class="event-badges">
          <span class="badge badge-{{ event.severity|lower }}">{{ event.severity }}</span>
          {% for cat in event.categories[:2] %}
          <span class="badge badge-cat">{{ cat }}</span>
          {% endfor %}
        </div>
        <div class="event-company">{{ event.company_name }}{% if event.product_line %} / {{ event.product_line }}{% endif %}</div>
        <div class="event-body">
          {% if event.summary_short %}{{ event.summary_short }}{% endif %}
        </div>
        {% if event.citations %}
        <div class="event-sources">
          Sources: {% for url in event.citations %}<a href="{{ url }}">{{ url|truncate(50) }}</a>{% if not loop.last %}, {% endif %}{% endfor %}
        </div>
        {% endif %}
      </div>
      {% endfor %}
    </div>
    {% endif %}

    <!-- PRICING & LIMITS -->
    {% if sections.pricing %}
    <div class="section">
      <div class="section-title">[4] Pricing &amp; Limits</div>
      {% for event in sections.pricing %}
      <div class="event">
        <div class="event-title">{{ event.title }}</div>
        <div class="event-badges">
          <span class="badge badge-{{ event.severity|lower }}">{{ event.severity }}</span>
        </div>
        <div class="event-body">{% if event.summary_short %}{{ event.summary_short }}{% endif %}</div>
        {% if event.citations %}
        <div class="event-sources">
          Sources: {% for url in event.citations %}<a href="{{ url }}">{{ url|truncate(50) }}</a>{% if not loop.last %}, {% endif %}{% endfor %}
        </div>
        {% endif %}
      </div>
      {% endfor %}
    </div>
    {% endif %}

    <!-- INCIDENTS & RELIABILITY -->
    {% if sections.incidents %}
    <div class="section">
      <div class="section-title">[5] Incidents &amp; Reliability</div>
      {% for event in sections.incidents %}
      <div class="event">
        <div class="event-title">{{ event.title }}</div>
        <div class="event-badges">
          <span class="badge badge-{{ event.severity|lower }}">{{ event.severity }}</span>
        </div>
        <div class="event-body">{% if event.summary_short %}{{ event.summary_short }}{% endif %}</div>
        {% if event.citations %}
        <div class="event-sources">
          Sources: {% for url in event.citations %}<a href="{{ url }}">{{ url|truncate(50) }}</a>{% if not loop.last %}, {% endif %}{% endfor %}
        </div>
        {% endif %}
      </div>
      {% endfor %}
    </div>
    {% endif %}

    <!-- COMMUNITY RADAR -->
    {% if sections.radar %}
    <div class="section">
      <div class="section-title">[6] Community Radar</div>
      {% for event in sections.radar %}
      <div class="radar-card">
        <h4>{{ event.title }}</h4>
        <p>{% if event.summary_short %}{{ event.summary_short }}{% endif %}</p>
        {% if event.citations %}
        <p>Try it: <a href="{{ event.citations[0] }}">{{ event.citations[0]|truncate(50) }}</a></p>
        {% endif %}
        {% if event.metadata_ is defined and event.metadata_ %}
        <div class="radar-signals">
          Signals: {% if event.metadata_.get('points') %}{{ event.metadata_.points }} points{% endif %}
          {% if event.metadata_.get('num_comments') %}, {{ event.metadata_.num_comments }} comments{% endif %}
        </div>
        {% endif %}
      </div>
      {% endfor %}
    </div>
    {% endif %}

    <!-- EVERYTHING ELSE -->
    {% if sections.everything_else %}
    <div class="section">
      <div class="section-title">[7] Everything Else (Skim)</div>
      {% for event in sections.everything_else %}
      <div class="skim-item">
        - {{ event.title }}
        <span class="badge badge-{{ event.severity|lower }}">{{ event.severity }}</span>
        {% if event.categories %}<span class="badge badge-cat">{{ event.categories[0] }}</span>{% endif %}
        {% if event.citations %} — <a href="{{ event.citations[0] }}">source</a>{% endif %}
      </div>
      {% endfor %}
    </div>
    {% endif %}

    <!-- FOOTER -->
    <div class="footer">
      <p>AI Daily Digest &mdash; automated, citation-backed AI industry updates.</p>
      <p><a href="#">Unsubscribe</a> | <a href="#">Preferences</a></p>
    </div>
  </div>
</body>
</html>
